/*
 * Created on 21 Jul 2015 ( Time 15:00:30 )
 * Generated by Telosys Tools Generator ( version 2.1.1 )
 */
package com.abm.mainet.common.master.service;

import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import javax.annotation.Resource;

import org.springframework.stereotype.Component;
import org.springframework.transaction.annotation.Transactional;

import com.abm.mainet.common.domain.BankMasterEntity;
import com.abm.mainet.common.master.dto.TbCustbanks;
import com.abm.mainet.common.master.dto.TbCustbanksMas;
import com.abm.mainet.common.master.mapper.TbCustbanksMasServiceMapper;
import com.abm.mainet.common.master.mapper.TbCustbanksServiceMapper;
import com.abm.mainet.common.master.repository.TbCustbanksMasJpaRepository;
import com.abm.mainet.common.utility.UserSession;

/**
 * Implementation of TbCustbanksMasService
 */
@Component
@Transactional
public class TbCustbanksMasServiceImpl implements TbCustbanksMasService {

    @Resource
    private TbCustbanksMasJpaRepository tbCustbanksMasJpaRepository;

    @Resource
    private TbCustbanksMasServiceMapper tbCustbanksMasServiceMapper;

    @Resource
    TbCustbanksServiceMapper tbCustbanksServiceMapper;

    @Override
    public TbCustbanksMas findById(final Long cmBankid) {
        final BankMasterEntity tbCustbanksMasEntity = tbCustbanksMasJpaRepository.findOne(cmBankid);
        return tbCustbanksMasServiceMapper.mapTbCustbanksMasEntityToTbCustbanksMas(tbCustbanksMasEntity);
    }

    @Override
    public List<TbCustbanksMas> findAll() {
        final Iterable<BankMasterEntity> entities = tbCustbanksMasJpaRepository.findAll();
        final List<TbCustbanksMas> beans = new ArrayList<>();
        for (final BankMasterEntity tbCustbanksMasEntity : entities) {
            beans.add(tbCustbanksMasServiceMapper.mapTbCustbanksMasEntityToTbCustbanksMas(tbCustbanksMasEntity));
        }
        return beans;
    }

    @Override
    public TbCustbanksMas save(final TbCustbanksMas tbCustbanksMas) {
        return save(tbCustbanksMas);
    }

    @Override
    public TbCustbanksMas create(final TbCustbanksMas tbCustbanksMas) {

        final BankMasterEntity tbCustbanksMasEntity = new BankMasterEntity();
        tbCustbanksMasServiceMapper.mapTbCustbanksMasToTbCustbanksMasEntity(tbCustbanksMas, tbCustbanksMasEntity);

        BankMasterEntity tbCustbanksEntity = null;
        final List<BankMasterEntity> tbCustbanksEntityList = new ArrayList<>();

        for (final TbCustbanks custBanks : tbCustbanksMas.getCustBanksList()) {
            tbCustbanksEntity = new BankMasterEntity();
            custBanks.setUserId(UserSession.getCurrent().getEmployee().getEmpId());
            custBanks.setLangId(Long.valueOf(UserSession.getCurrent().getLanguageId()));
            custBanks.setLmoddate(new Date());
            custBanks.setCbBankname(tbCustbanksMas.getCmBankname());
            custBanks.setTbCustbanksMas(tbCustbanksMas);
            tbCustbanksServiceMapper.mapTbCustbanksToTbCustbanksEntity(custBanks, tbCustbanksEntity);
            tbCustbanksEntityList.add(tbCustbanksEntity);
        }
        final BankMasterEntity tbCustbanksMasEntitySaved = tbCustbanksMasJpaRepository.save(tbCustbanksMasEntity);
        return tbCustbanksMasServiceMapper.mapTbCustbanksMasEntityToTbCustbanksMas(tbCustbanksMasEntitySaved);
    }

    @Override
    public TbCustbanksMas update(final TbCustbanksMas tbCustbanksMas, final TbCustbanksMas custbanksMasTemp) {
        final BankMasterEntity tbCustbanksMasEntity = tbCustbanksMasJpaRepository.findOne(tbCustbanksMas.getCmBankid());
        tbCustbanksMasServiceMapper.mapTbCustbanksMasToTbCustbanksMasEntity(tbCustbanksMas, tbCustbanksMasEntity);

        tbCustbanksMasEntity.setLangId(custbanksMasTemp.getLangId());
        tbCustbanksMasEntity.setLgIpMac(custbanksMasTemp.getLgIpMac());
        tbCustbanksMasEntity.setUpdatedBy(UserSession.getCurrent().getEmployee().getEmpId());
        tbCustbanksMasEntity.setUpdatedDate(new Date());

        BankMasterEntity tbCustbanksEntity = null;
        final List<BankMasterEntity> tbCustbanksEntityList = new ArrayList<>();
        final Date date = new Date();
        for (final TbCustbanks custBanks : tbCustbanksMas.getCustBanksList()) {
            tbCustbanksEntity = new BankMasterEntity();
            if (custBanks.getCbBankid() == null) {
                custBanks.setUserId(UserSession.getCurrent().getEmployee().getEmpId());
                custBanks.setLangId(Long.valueOf(UserSession.getCurrent().getLanguageId()));
                custBanks.setLmoddate(date);
                custBanks.setCbBankname(tbCustbanksMas.getCmBankname());
            } else {
                custBanks.setUpdatedBy(UserSession.getCurrent().getEmployee().getEmpId());
                custBanks.setUpdatedDate(new Date());
            }
            custBanks.setTbCustbanksMas(tbCustbanksMas);
            tbCustbanksServiceMapper.mapTbCustbanksToTbCustbanksEntity(custBanks, tbCustbanksEntity);
            tbCustbanksEntityList.add(tbCustbanksEntity);
        }

        final BankMasterEntity tbCustbanksMasEntitySaved = tbCustbanksMasJpaRepository.save(tbCustbanksMasEntity);
        return tbCustbanksMasServiceMapper.mapTbCustbanksMasEntityToTbCustbanksMas(tbCustbanksMasEntitySaved);
    }

    @Override
    public void delete(final Long cmBankid) {
        tbCustbanksMasJpaRepository.delete(cmBankid);
    }

    public TbCustbanksMasJpaRepository getTbCustbanksMasJpaRepository() {
        return tbCustbanksMasJpaRepository;
    }

    public void setTbCustbanksMasJpaRepository(final TbCustbanksMasJpaRepository tbCustbanksMasJpaRepository) {
        this.tbCustbanksMasJpaRepository = tbCustbanksMasJpaRepository;
    }

    public TbCustbanksMasServiceMapper getTbCustbanksMasServiceMapper() {
        return tbCustbanksMasServiceMapper;
    }

    public void setTbCustbanksMasServiceMapper(final TbCustbanksMasServiceMapper tbCustbanksMasServiceMapper) {
        this.tbCustbanksMasServiceMapper = tbCustbanksMasServiceMapper;
    }

}
